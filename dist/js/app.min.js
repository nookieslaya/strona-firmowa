"use strict";function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var navMenu=document.getElementById("nav-menu"),toggleMenu=document.getElementById("nav-toggle"),closeMenu=document.getElementById("nav-close"),footerYear=document.querySelector(".footer__year");toggleMenu.addEventListener("click",function(){navMenu.classList.toggle("show")}),closeMenu.addEventListener("click",function(){navMenu.classList.remove("show")});var navLink=document.querySelectorAll(".nav__link");function linkAction(){navLink.forEach(function(e){return e.classList.remove("active")}),this.classList.add("active"),navMenu.classList.remove("show")}navLink.forEach(function(e){return e.addEventListener("click",linkAction)});var TypeWriter=function(){function r(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e3;_classCallCheck(this,r),this.txtElement=e,this.words=t,this.txt="",this.wordIndex=0,this.wait=parseInt(n,10),this.type(),this.isDeleting=!1}return _createClass(r,[{key:"type",value:function(){var e=this,t=this.wordIndex%this.words.length,n=this.words[t];this.isDeleting?this.txt=n.substring(0,this.txt.length-1):this.txt=n.substring(0,this.txt.length+1),this.txtElement.innerHTML='<span class="txt">'.concat(this.txt,"</span>");t=100;this.isDeleting&&(t/=2),this.isDeleting||this.txt!==n?this.isDeleting&&""===this.txt&&(this.isDeleting=!1,this.wordIndex++,t=500):(t=this.wait,this.isDeleting=!0),setTimeout(function(){return e.type()},t)}}]),r}();function init(){var e=document.querySelector(".txt-type"),t=JSON.parse(e.getAttribute("data-words")),n=e.getAttribute("data-wait");new TypeWriter(e,t,n)}document.addEventListener("DOMContentLoaded",init);var accordion=document.querySelector(".accordion"),accordionBtns=document.querySelectorAll(".accordion-btn");function openAccordionItems(){this.nextElementSibling.classList.contains("active")?this.nextElementSibling.classList.remove("active"):(closeAccordionItem(),this.nextElementSibling.classList.toggle("active"))}var closeAccordionItem=function(){document.querySelectorAll(".accordion-info").forEach(function(e){return e.classList.remove("active")})},clickOutsideAccordion=function(e){e.target.classList.contains("accordion-btn")||e.target.classList.contains("accordion-info")||e.target.classList.contains("accordion-info-text")||closeAccordionItem()};accordionBtns.forEach(function(e){return e.addEventListener("click",openAccordionItems)}),window.addEventListener("click",clickOutsideAccordion);var formPages=document.querySelectorAll(".page"),steps=document.querySelectorAll(".step"),progressBar=document.querySelector(".progress-bar"),prevBtn=document.querySelector(".btn-prev"),nextBtn=document.querySelector(".btn-next"),currentStep=1,handleNextBtn=function(){++currentStep>steps.length&&(currentStep=steps.length),handleProgressBar()},handlePrevBtn=function(){--currentStep<1&&(currentStep=1),handleProgressBar()},handleProgressBar=function(){steps.forEach(function(e,t){t<currentStep?e.classList.add("active-step"):e.classList.remove("active-step")});var e=document.querySelectorAll(".active-step");progressBar.style.width=(e.length-1)/(steps.length-1)*100+"%",handleButtons(),handleFormPage()},handleButtons=function(){1===currentStep?prevBtn.disabled=!0:currentStep===steps.length?nextBtn.disabled=!0:(prevBtn.disabled=!1,nextBtn.disabled=!1)},handleFormPage=function(){formPages.forEach(function(e){currentStep==e.dataset.number?e.classList.add("active-page"):e.classList.remove("active-page")})};nextBtn.addEventListener("click",handleNextBtn),prevBtn.addEventListener("click",handlePrevBtn),function(){function s(e){null!==(e=e.nextElementSibling)&&e.classList.contains("form-error-text")&&e.remove()}function c(e,t){null!==(e=e.nextElementSibling)&&e.classList.contains("form-error-text")&&(e.style.display=t?"block":"none",e.setAttribute("aria-hidden",t))}function l(e,t){t?e.classList.add("field-error"):(e.classList.remove("field-error"),c(e,!1))}var d=document.querySelector("#contactForm"),u=d.querySelectorAll("[required]");d.setAttribute("novalidate",!0);var e,t=_createForOfIteratorHelper(u);try{for(t.s();!(e=t.n()).done;)e.value.addEventListener("input",function(e){return l(e.target,!e.target.checkValidity())})}catch(e){t.e(e)}finally{t.f()}d.addEventListener("submit",function(e){e.preventDefault();var t,n=_createForOfIteratorHelper(u);try{for(n.s();!(t=n.n()).done;){var r=t.value;s(r),r.classList.remove("field-error"),r.checkValidity()||(function(e,t){s(e);var n=document.createElement("div");n.classList.add("form-error-text"),n.innerText=t,null===e.nextElementSibling?e.parentElement.appendChild(n):e.nextElementSibling.classList.contains("form-error-text")||e.parentElement.insertBefore(n,e.nextElementSibling)}(r,r.dataset.errorText),r.classList.add("field-error"),formHasErrors=!0)}}catch(e){n.e(e)}finally{n.f()}var o=d.querySelector("[type=submit]");o.disabled=!0,o.classList.add("loading");var i=new FormData(d),a=d.getAttribute("action"),e=d.getAttribute("method");fetch(a,{method:e.toUpperCase(),body:i}).then(function(e){return e.json()}).then(function(e){if(e.errors){var t,n=e.errors.map(function(e){return'[name="'.concat(e,'"]')}),r=_createForOfIteratorHelper(d.querySelectorAll(n.join(",")));try{for(r.s();!(t=r.n()).done;){var i=t.value;l(i,!0),c(i,!0)}}catch(e){r.e(e)}finally{r.f()}}else"ok"===e.status&&((n=document.createElement("div")).classList.add("form-send-success"),n.innerText="Wysłanie wiadomości się nie powiodło",d.parentElement.insertBefore(n,d),n.innerHTML="\n                            <strong>Wiadomość została wysłana</strong>\n                            <span>Dziękujemy za kontakt. Postaram się odpowiedzieć jak najszybciej</span>\n                        ",d.remove()),"error"===e.status&&((e=document.querySelector(".form-send-error"))&&e.remove(),(e=document.createElement("div")).classList.add("form-send-error"),e.innerText="Wysłanie wiadomości się nie powiodło",o.parentElement.appendChild(e))}).finally(function(){o.disabled=!1,o.classList.remove("loading")})})}();var handleCurrentYear=function(){var e=(new Date).getFullYear();footerYear.innerText=e};handleCurrentYear();var sr=ScrollReveal({distance:"100px",duration:2e3,delay:200});sr.reveal(".header__container"),sr.reveal(".header__text",{delay:400,origin:"top"}),sr.reveal(".about__text-container",{interval:100,origin:"left"}),sr.reveal(".about__img",{interval:100,origin:"bottom"}),sr.reveal(" .product",{interval:100,origin:"top"}),sr.reveal(".card1,.accordion-btn",{interval:100,origin:"left"}),sr.reveal(".btn-acc,.ask1",{interval:100,origin:"left"}),sr.reveal(".form,.card3,.ask3 ",{origin:"bottom"}),sr.reveal(".contact__container",{origin:"left"}),sr.reveal(".card2,.ask2,.ask4",{origin:"top"}),sr.reveal(".about__title,\n.question__title,\n.offer__title,\n.steps__title,\n.contact__title,\n.products__title",{delay:200});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJuYXZNZW51IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRvZ2dsZU1lbnUiLCJjbG9zZU1lbnUiLCJmb290ZXJZZWFyIiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZW1vdmUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiYWRkIiwibmF2TGluayIsImxpbmtBY3Rpb24iLCJUeXBlV3JpdGVyIiwidHh0RWxlbWVudCIsIndvcmRzIiwid2FpdCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJ0eHQiLCJmb3JFYWNoIiwidHlwZSIsImlzRGVsZXRpbmciLCJjdXJyZW50Iiwid29yZEluZGV4IiwiZnVsbFR4dCIsInN1YnN0cmluZyIsImlubmVySFRNTCIsImNvbmNhdCIsInR5cGVTcGVlZCIsInNldFRpbWVvdXQiLCJfdGhpcyIsImluaXQiLCJKU09OIiwicGFyc2UiLCJnZXRBdHRyaWJ1dGUiLCJhY2NvcmRpb24iLCJhY2NvcmRpb25CdG5zIiwib3BlbkFjY29yZGlvbkl0ZW1zIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiY29udGFpbnMiLCJpdGVtIiwiY2xpY2tPdXRzaWRlQWNjb3JkaW9uIiwiZSIsInRhcmdldCIsImFsbEFjdGl2ZUl0ZW1zIiwiYnRuIiwid2luZG93IiwiZm9ybVBhZ2VzIiwic3RlcHMiLCJwcm9ncmVzc0JhciIsInByZXZCdG4iLCJuZXh0QnRuIiwiY3VycmVudFN0ZXAiLCJoYW5kbGVQcm9ncmVzc0JhciIsInN0ZXAiLCJpbmRleCIsImFjdGl2ZVN0ZXBzIiwiaGFuZGxlQnV0dG9ucyIsImhhbmRsZUZvcm1QYWdlIiwiZGlzYWJsZWQiLCJwYWdlIiwiZGF0YXNldCIsIm51bWJlciIsImhhbmRsZU5leHRCdG4iLCJoYW5kbGVQcmV2QnRuIiwiZXJyb3JUZXh0IiwiZmllbGQiLCJ0b2dnbGVFcnJvckZpZWxkIiwic2hvdyIsImRpc3BsYXkiLCJzZXRBdHRyaWJ1dGUiLCJmb3JtIiwiaW5wdXRzIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsInZhbHVlIiwibWFya0ZpZWxkQXNFcnJvciIsImNoZWNrVmFsaWRpdHkiLCJlcnIiLCJmIiwicHJldmVudERlZmF1bHQiLCJfc3RlcDIiLCJfaXRlcmF0b3IyIiwicyIsIm4iLCJkb25lIiwiZWwiLCJyZW1vdmVGaWVsZEVycm9yIiwiY3JlYXRlRWxlbWVudCIsImRpdiIsInBhcmVudEVsZW1lbnQiLCJpbnNlcnRCZWZvcmUiLCJjcmVhdGVGaWVsZEVycm9yIiwiZm9ybUhhc0Vycm9ycyIsInN1Ym1pdCIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJ1cmwiLCJmZXRjaCIsInRvVXBwZXJDYXNlIiwicmVzIiwianNvbiIsInRoZW4iLCJlcnJvcnMiLCJfc3RlcDMiLCJzZWxlY3RvcnMiLCJtYXAiLCJfaXRlcmF0b3IzIiwiam9pbiIsInN0YXR1cyIsInN0YXR1c0Vycm9yIiwiaW5uZXJUZXh0IiwiYXBwZW5kQ2hpbGQiLCJ5ZWFyIiwiaGFuZGxlQ3VycmVudFllYXIiLCJzciIsIlNjcm9sbFJldmVhbCIsImRpc3RhbmNlIiwiZHVyYXRpb24iLCJyZXZlYWwiLCJkZWxheSIsIm9yaWdpbiIsImludGVydmFsIl0sIm1hcHBpbmdzIjoieWhEQUFBLElBQU1BLFFBQVVDLFNBQVNDLGVBQWUsWUFDbENDLFdBQWFGLFNBQVNDLGVBQWUsY0FDckNFLFVBQVlILFNBQVNDLGVBQWUsYUFFcENHLFdBQWFKLFNBQVNLLGNBQWMsaUJBSTFDSCxXQUFXSSxpQkFBaUIsUUFBUyxXQUNqQ1AsUUFBUVEsVUFBVUMsT0FBTyxVQUU3QkwsVUFBVUcsaUJBQWlCLFFBQVMsV0FDaENQLFFBQVFRLFVBQVVFLE9BQU8sVUFYN0IsSUFBTVAsUUFBVUYsU0FBV1UsaUJBQWdCLGNBRzNDLFNBQU1OLGFBSU5GLFFBQVdJLFFBQUFBLFNB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QUNMRCxXQUFBQSxVQUFBd0IsR0FtQzVCQyxvQkF6QjRCLElBQUFDLEdBQUFDLGFBQU1OLENBK0I5Qk8sU0FBVSxRQTlCY0MsU0FBQSxJQUNJUixNQUFBQSxNQUdKSyxHQUFBSSxPQUFBLHNCQWdDNUJKLEdBQUdJLE9BQUgsZ0JBQTJCLENBQUVDLE1BQU8sSUFBS0MsT0FBUSxRQS9CckJoQyxHQUFBQSxPQUFBQSx5QkFBa0IsQ0FBQWlDLFNBQUEsSUFBbEJELE9BQUEsU0FpQzVCTixHQUFHSSxPQUFILGNBQXlCLENBQUVHLFNBQVUsSUFBS0QsT0FBUSxXQWhDdEJoQyxHQUFBQSxPQUFBQSxZQUFJc0IsQ0FBQUEsU0FBWSxJQUFBVSxPQUFBLFFBQ2hCM0IsR0FBQUEsT0FBQUEsd0JBQXFCa0IsQ0FBQUEsU0FBWXZCLElBQWpDZ0MsT0FBQSxTQUNITixHQUFBSSxPQUFBLGlCQUFBLENBQUFHLFNBQUEsSUFBQUQsT0FBQSxTQUNKTixHQUFBSSxPQUFBLHNCQUFBLENBQUFFLE9BQUEsV0FDSk4sR0FBQUksT0FBQSxzQkFBVSxDQUFNRSxPQUFBLFNBRWIzQixHQUFBQSxPQUFBQSxxQkFBaUIzRixDQUFPc0gsT0FBQSxRQTNINUNOLEdBQUFJLE9BQUEsd0dBb0llUixDQUFBQSxNQUFZRSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbmF2TWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXYtbWVudScpXHJcbmNvbnN0IHRvZ2dsZU1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmF2LXRvZ2dsZScpXHJcbmNvbnN0IGNsb3NlTWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXYtY2xvc2UnKVxyXG5cclxuY29uc3QgZm9vdGVyWWVhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb290ZXJfX3llYXInKVxyXG5cclxuXHJcblxyXG50b2dnbGVNZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgbmF2TWVudS5jbGFzc0xpc3QudG9nZ2xlKCdzaG93JylcclxufSlcclxuY2xvc2VNZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgbmF2TWVudS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JylcclxufSlcclxuXHJcbmNvbnN0IG5hdkxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubmF2X19saW5rJylcclxuXHJcbmZ1bmN0aW9uIGxpbmtBY3Rpb24oKSB7XHJcbiAgICBuYXZMaW5rLmZvckVhY2goZSA9PiBlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKVxyXG4gICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxyXG5cclxuICAgIG5hdk1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpXHJcbn1cclxuXHJcbm5hdkxpbmsuZm9yRWFjaChlID0+IGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsaW5rQWN0aW9uKSlcclxuXHJcblxyXG5cclxuLy8gdHlwaW5nXHJcbmNsYXNzIFR5cGVXcml0ZXIge1xyXG4gICAgY29uc3RydWN0b3IodHh0RWxlbWVudCwgd29yZHMsIHdhaXQgPSAxMDAwKSB7XHJcbiAgICAgICAgdGhpcy50eHRFbGVtZW50ID0gdHh0RWxlbWVudDtcclxuICAgICAgICB0aGlzLndvcmRzID0gd29yZHM7XHJcbiAgICAgICAgdGhpcy50eHQgPSAnJztcclxuICAgICAgICB0aGlzLndvcmRJbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy53YWl0ID0gcGFyc2VJbnQod2FpdCwgMTApO1xyXG4gICAgICAgIHRoaXMudHlwZSgpO1xyXG4gICAgICAgIHRoaXMuaXNEZWxldGluZyA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHR5cGUoKSB7XHJcbiAgICAgICAgLy8gQ3VycmVudCBpbmRleCBvZiB3b3JkXHJcbiAgICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMud29yZEluZGV4ICUgdGhpcy53b3Jkcy5sZW5ndGg7XHJcbiAgICAgICAgLy8gR2V0IGZ1bGwgdGV4dCBvZiBjdXJyZW50IHdvcmRcclxuICAgICAgICBjb25zdCBmdWxsVHh0ID0gdGhpcy53b3Jkc1tjdXJyZW50XTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgZGVsZXRpbmdcclxuICAgICAgICBpZiAodGhpcy5pc0RlbGV0aW5nKSB7XHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSBjaGFyXHJcbiAgICAgICAgICAgIHRoaXMudHh0ID0gZnVsbFR4dC5zdWJzdHJpbmcoMCwgdGhpcy50eHQubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gQWRkIGNoYXJcclxuICAgICAgICAgICAgdGhpcy50eHQgPSBmdWxsVHh0LnN1YnN0cmluZygwLCB0aGlzLnR4dC5sZW5ndGggKyAxKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEluc2VydCB0eHQgaW50byBlbGVtZW50XHJcbiAgICAgICAgdGhpcy50eHRFbGVtZW50LmlubmVySFRNTCA9IGA8c3BhbiBjbGFzcz1cInR4dFwiPiR7dGhpcy50eHR9PC9zcGFuPmA7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWwgVHlwZSBTcGVlZFxyXG4gICAgICAgIGxldCB0eXBlU3BlZWQgPSAxMDA7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzRGVsZXRpbmcpIHtcclxuICAgICAgICAgICAgdHlwZVNwZWVkIC89IDI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBJZiB3b3JkIGlzIGNvbXBsZXRlXHJcbiAgICAgICAgaWYgKCF0aGlzLmlzRGVsZXRpbmcgJiYgdGhpcy50eHQgPT09IGZ1bGxUeHQpIHtcclxuICAgICAgICAgICAgLy8gTWFrZSBwYXVzZSBhdCBlbmRcclxuICAgICAgICAgICAgdHlwZVNwZWVkID0gdGhpcy53YWl0O1xyXG4gICAgICAgICAgICAvLyBTZXQgZGVsZXRlIHRvIHRydWVcclxuICAgICAgICAgICAgdGhpcy5pc0RlbGV0aW5nID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaXNEZWxldGluZyAmJiB0aGlzLnR4dCA9PT0gJycpIHtcclxuICAgICAgICAgICAgdGhpcy5pc0RlbGV0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIE1vdmUgdG8gbmV4dCB3b3JkXHJcbiAgICAgICAgICAgIHRoaXMud29yZEluZGV4Kys7XHJcbiAgICAgICAgICAgIC8vIFBhdXNlIGJlZm9yZSBzdGFydCB0eXBpbmdcclxuICAgICAgICAgICAgdHlwZVNwZWVkID0gNTAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnR5cGUoKSwgdHlwZVNwZWVkKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbi8vIEluaXQgT24gRE9NIExvYWRcclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXQpO1xyXG5cclxuLy8gSW5pdCBBcHBcclxuZnVuY3Rpb24gaW5pdCgpIHtcclxuICAgIGNvbnN0IHR4dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudHh0LXR5cGUnKTtcclxuICAgIGNvbnN0IHdvcmRzID0gSlNPTi5wYXJzZSh0eHRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS13b3JkcycpKTtcclxuICAgIGNvbnN0IHdhaXQgPSB0eHRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS13YWl0Jyk7XHJcbiAgICAvLyBJbml0IFR5cGVXcml0ZXJcclxuICAgIG5ldyBUeXBlV3JpdGVyKHR4dEVsZW1lbnQsIHdvcmRzLCB3YWl0KTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuLy9hY2NvcmRpb25cclxuY29uc3QgYWNjb3JkaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFjY29yZGlvbicpXHJcbmNvbnN0IGFjY29yZGlvbkJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWNjb3JkaW9uLWJ0bicpXHJcblxyXG5mdW5jdGlvbiBvcGVuQWNjb3JkaW9uSXRlbXMoKSB7XHJcblxyXG4gICAgaWYgKHRoaXMubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcclxuICAgICAgICB0aGlzLm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgY2xvc2VBY2NvcmRpb25JdGVtKClcclxuICAgICAgICB0aGlzLm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKVxyXG5cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmNvbnN0IGNsb3NlQWNjb3JkaW9uSXRlbSA9ICgpID0+IHtcclxuICAgIGNvbnN0IGFsbEFjdGl2ZUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFjY29yZGlvbi1pbmZvJylcclxuICAgIGFsbEFjdGl2ZUl0ZW1zLmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKVxyXG59XHJcblxyXG5jb25zdCBjbGlja091dHNpZGVBY2NvcmRpb24gPSBlID0+IHtcclxuICAgIGlmIChcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2FjY29yZGlvbi1idG4nKSB8fFxyXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYWNjb3JkaW9uLWluZm8nKSB8fFxyXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYWNjb3JkaW9uLWluZm8tdGV4dCcpXHJcbiAgICApXHJcbiAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgY2xvc2VBY2NvcmRpb25JdGVtKClcclxufVxyXG5cclxuYWNjb3JkaW9uQnRucy5mb3JFYWNoKGJ0biA9PiBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuQWNjb3JkaW9uSXRlbXMpKVxyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xpY2tPdXRzaWRlQWNjb3JkaW9uKVxyXG5cclxuXHJcblxyXG4vLyBzdGVwc1xyXG5cclxuY29uc3QgZm9ybVBhZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBhZ2UnKVxyXG5jb25zdCBzdGVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zdGVwJylcclxuY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZ3Jlc3MtYmFyJylcclxuY29uc3QgcHJldkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idG4tcHJldicpXHJcbmNvbnN0IG5leHRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRuLW5leHQnKVxyXG5cclxubGV0IGN1cnJlbnRTdGVwID0gMVxyXG5cclxuY29uc3QgaGFuZGxlTmV4dEJ0biA9ICgpID0+IHtcclxuICAgIGN1cnJlbnRTdGVwKytcclxuXHJcbiAgICBpZiAoY3VycmVudFN0ZXAgPiBzdGVwcy5sZW5ndGgpIHtcclxuICAgICAgICBjdXJyZW50U3RlcCA9IHN0ZXBzLmxlbmd0aFxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZVByb2dyZXNzQmFyKClcclxufVxyXG5cclxuY29uc3QgaGFuZGxlUHJldkJ0biA9ICgpID0+IHtcclxuICAgIGN1cnJlbnRTdGVwLS1cclxuXHJcbiAgICBpZiAoY3VycmVudFN0ZXAgPCAxKSB7XHJcbiAgICAgICAgY3VycmVudFN0ZXAgPSAxXHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlUHJvZ3Jlc3NCYXIoKVxyXG59XHJcblxyXG5jb25zdCBoYW5kbGVQcm9ncmVzc0JhciA9ICgpID0+IHtcclxuICAgIHN0ZXBzLmZvckVhY2goKHN0ZXAsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgaWYgKGluZGV4IDwgY3VycmVudFN0ZXApIHtcclxuICAgICAgICAgICAgc3RlcC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUtc3RlcCcpXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RlcC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUtc3RlcCcpXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBjb25zdCBhY3RpdmVTdGVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hY3RpdmUtc3RlcCcpXHJcblxyXG4gICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAoKGFjdGl2ZVN0ZXBzLmxlbmd0aCAtIDEpIC8gKHN0ZXBzLmxlbmd0aCAtIDEpKSAqIDEwMCArICclJ1xyXG5cclxuICAgIGhhbmRsZUJ1dHRvbnMoKVxyXG4gICAgaGFuZGxlRm9ybVBhZ2UoKVxyXG59XHJcblxyXG5jb25zdCBoYW5kbGVCdXR0b25zID0gKCkgPT4ge1xyXG4gICAgaWYgKGN1cnJlbnRTdGVwID09PSAxKSB7XHJcbiAgICAgICAgcHJldkJ0bi5kaXNhYmxlZCA9IHRydWVcclxuICAgIH0gZWxzZSBpZiAoY3VycmVudFN0ZXAgPT09IHN0ZXBzLmxlbmd0aCkge1xyXG4gICAgICAgIG5leHRCdG4uZGlzYWJsZWQgPSB0cnVlXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHByZXZCdG4uZGlzYWJsZWQgPSBmYWxzZVxyXG4gICAgICAgIG5leHRCdG4uZGlzYWJsZWQgPSBmYWxzZVxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBoYW5kbGVGb3JtUGFnZSA9ICgpID0+IHtcclxuICAgIGZvcm1QYWdlcy5mb3JFYWNoKHBhZ2UgPT4ge1xyXG4gICAgICAgIGlmIChjdXJyZW50U3RlcCA9PSBwYWdlLmRhdGFzZXQubnVtYmVyKSB7XHJcbiAgICAgICAgICAgIHBhZ2UuY2xhc3NMaXN0LmFkZCgnYWN0aXZlLXBhZ2UnKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBhZ2UuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlLXBhZ2UnKVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn1cclxuXHJcbm5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVOZXh0QnRuKVxyXG5wcmV2QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlUHJldkJ0bilcclxuXHJcblxyXG5cclxuXHJcbi8vIGZvcm0gXHJcblxyXG57XHJcbiAgICBmdW5jdGlvbiByZW1vdmVGaWVsZEVycm9yKGZpZWxkKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JUZXh0ID0gZmllbGQubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG4gICAgICAgIGlmIChlcnJvclRleHQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKGVycm9yVGV4dC5jbGFzc0xpc3QuY29udGFpbnMoXCJmb3JtLWVycm9yLXRleHRcIikpIHtcclxuICAgICAgICAgICAgICAgIGVycm9yVGV4dC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gY3JlYXRlRmllbGRFcnJvcihmaWVsZCwgdGV4dCkge1xyXG4gICAgICAgIHJlbW92ZUZpZWxkRXJyb3IoZmllbGQpOyAvL3ByemVkIHN0d29yemVuaWVtIHVzdXdhbSBieSB6YXdzemUgYnnFgiBuYWpub3dzenkga29tdW5pa2F0XHJcblxyXG4gICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoXCJmb3JtLWVycm9yLXRleHRcIik7XHJcbiAgICAgICAgZGl2LmlubmVyVGV4dCA9IHRleHQ7XHJcbiAgICAgICAgaWYgKGZpZWxkLm5leHRFbGVtZW50U2libGluZyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBmaWVsZC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGRpdik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKCFmaWVsZC5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZm9ybS1lcnJvci10ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZC5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShkaXYsIGZpZWxkLm5leHRFbGVtZW50U2libGluZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIHRvZ2dsZUVycm9yRmllbGQoZmllbGQsIHNob3cpIHtcclxuICAgICAgICBjb25zdCBlcnJvclRleHQgPSBmaWVsZC5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICAgICAgaWYgKGVycm9yVGV4dCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3JUZXh0LmNsYXNzTGlzdC5jb250YWlucyhcImZvcm0tZXJyb3ItdGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgZXJyb3JUZXh0LnN0eWxlLmRpc3BsYXkgPSBzaG93ID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcbiAgICAgICAgICAgICAgICBlcnJvclRleHQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsIHNob3cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBtYXJrRmllbGRBc0Vycm9yKGZpZWxkLCBzaG93KSB7XHJcbiAgICAgICAgaWYgKHNob3cpIHtcclxuICAgICAgICAgICAgZmllbGQuY2xhc3NMaXN0LmFkZChcImZpZWxkLWVycm9yXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZpZWxkLmNsYXNzTGlzdC5yZW1vdmUoXCJmaWVsZC1lcnJvclwiKTtcclxuICAgICAgICAgICAgdG9nZ2xlRXJyb3JGaWVsZChmaWVsZCwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY29udGFjdEZvcm1cIik7XHJcbiAgICBjb25zdCBpbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbcmVxdWlyZWRdXCIpO1xyXG5cclxuICAgIC8vd3nFgsSFY3phbXkgZG9tecWbbG7EhSB3YWxpZGFjasSZXHJcbiAgICBmb3JtLnNldEF0dHJpYnV0ZShcIm5vdmFsaWRhdGVcIiwgdHJ1ZSk7XHJcblxyXG4gICAgZm9yIChjb25zdCBlbCBvZiBpbnB1dHMpIHtcclxuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZSA9PiBtYXJrRmllbGRBc0Vycm9yKGUudGFyZ2V0LCAhZS50YXJnZXQuY2hlY2tWYWxpZGl0eSgpKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGUgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgbGV0IGZvcm1FcnJvcnMgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy8yIGV0YXAgLSBzcHJhd2R6YW15IHBvc3pjemVnw7NsbmUgcG9sYSBnZHkga3RvxZsgY2hjZSB3eXPFgmHEhyBmb3JtdWxhcnpcclxuICAgICAgICBmb3IgKGNvbnN0IGVsIG9mIGlucHV0cykge1xyXG4gICAgICAgICAgICByZW1vdmVGaWVsZEVycm9yKGVsKTtcclxuICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShcImZpZWxkLWVycm9yXCIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFlbC5jaGVja1ZhbGlkaXR5KCkpIHtcclxuICAgICAgICAgICAgICAgIGNyZWF0ZUZpZWxkRXJyb3IoZWwsIGVsLmRhdGFzZXQuZXJyb3JUZXh0KTtcclxuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoXCJmaWVsZC1lcnJvclwiKTtcclxuICAgICAgICAgICAgICAgIGZvcm1IYXNFcnJvcnMgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWZvcm1FcnJvcnMpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3VibWl0ID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiW3R5cGU9c3VibWl0XVwiKTtcclxuICAgICAgICAgICAgc3VibWl0LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgc3VibWl0LmNsYXNzTGlzdC5hZGQoXCJsb2FkaW5nXCIpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZm9ybSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGZvcm0uZ2V0QXR0cmlidXRlKFwiYWN0aW9uXCIpO1xyXG4gICAgICAgICAgICBjb25zdCBtZXRob2QgPSBmb3JtLmdldEF0dHJpYnV0ZShcIm1ldGhvZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGZldGNoKHVybCwge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QudG9VcHBlckNhc2UoKSxcclxuICAgICAgICAgICAgICAgIGJvZHk6IGZvcm1EYXRhXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5lcnJvcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0b3JzID0gcmVzLmVycm9ycy5tYXAoZWwgPT4gYFtuYW1lPVwiJHtlbH1cIl1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRzV2l0aEVycm9ycyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMuam9pbihcIixcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGVsIG9mIGZpZWxkc1dpdGhFcnJvcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtGaWVsZEFzRXJyb3IoZWwsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlRXJyb3JGaWVsZChlbCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gXCJva1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoXCJmb3JtLXNlbmQtc3VjY2Vzc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lclRleHQgPSBcIld5c8WCYW5pZSB3aWFkb21vxZtjaSBzacSZIG5pZSBwb3dpb2TFgm9cIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGRpdiwgZm9ybSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXYuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz5XaWFkb21vxZvEhyB6b3N0YcWCYSB3eXPFgmFuYTwvc3Ryb25nPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+RHppxJlrdWplbXkgemEga29udGFrdC4gUG9zdGFyYW0gc2nEmSBvZHBvd2llZHppZcSHIGphayBuYWpzenliY2llajwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0ucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IFwiZXJyb3JcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9qZcW8ZWxpIGlzdG5pZWplIGtvbXVuaWthdCBvIGLFgsSZZHppZSB3eXN5xYJraVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9ucC4gZ2VuZXJvd2FueSBwcnp5IHBvcHJ6ZWRuaW0gd3lzecWCYW5pdSBmb3JtdWxhcnphXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3VzdXdhbXkgZ28sIGJ5IG5pZSBkdXBsaWtvd2HEhyB0eWNoIGtvbXVuaWthdMOzd1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhdHVzRXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm0tc2VuZC1lcnJvclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXNFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c0Vycm9yLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChcImZvcm0tc2VuZC1lcnJvclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lclRleHQgPSBcIld5c8WCYW5pZSB3aWFkb21vxZtjaSBzacSZIG5pZSBwb3dpb2TFgm9cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGRpdik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KS5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBzdWJtaXQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzdWJtaXQuY2xhc3NMaXN0LnJlbW92ZShcImxvYWRpbmdcIik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcbmNvbnN0IGhhbmRsZUN1cnJlbnRZZWFyID0gKCkgPT4ge1xyXG4gICAgY29uc3QgeWVhciA9IChuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKTtcclxuICAgIGZvb3RlclllYXIuaW5uZXJUZXh0ID0geWVhcjtcclxuXHJcbn1cclxuaGFuZGxlQ3VycmVudFllYXIoKVxyXG5cclxuXHJcbi8vIHNjcm9sbCByZXZlYWwgXHJcblxyXG5jb25zdCBzciA9IFNjcm9sbFJldmVhbCh7XHJcbiAgICBkaXN0YW5jZTogJzEwMHB4JyxcclxuICAgIGR1cmF0aW9uOiAyMDAwLFxyXG4gICAgZGVsYXk6IDIwMFxyXG59KVxyXG5cclxuc3IucmV2ZWFsKGAuaGVhZGVyX19jb250YWluZXJgKVxyXG5zci5yZXZlYWwoYC5oZWFkZXJfX3RleHRgLCB7IGRlbGF5OiA0MDAsIG9yaWdpbjogXCJ0b3BcIiB9KVxyXG5zci5yZXZlYWwoYC5hYm91dF9fdGV4dC1jb250YWluZXJgLCB7IGludGVydmFsOiAxMDAsIG9yaWdpbjogXCJsZWZ0XCIgfSlcclxuc3IucmV2ZWFsKGAuYWJvdXRfX2ltZ2AsIHsgaW50ZXJ2YWw6IDEwMCwgb3JpZ2luOiBcImJvdHRvbVwiIH0pXHJcbnNyLnJldmVhbChgIC5wcm9kdWN0YCwgeyBpbnRlcnZhbDogMTAwLCBvcmlnaW46IFwidG9wXCIgfSlcclxuc3IucmV2ZWFsKGAuY2FyZDEsLmFjY29yZGlvbi1idG5gLCB7IGludGVydmFsOiAxMDAsIG9yaWdpbjogXCJsZWZ0XCIgfSlcclxuc3IucmV2ZWFsKGAuYnRuLWFjYywuYXNrMWAsIHsgaW50ZXJ2YWw6IDEwMCwgb3JpZ2luOiBcImxlZnRcIiB9KVxyXG5zci5yZXZlYWwoYC5mb3JtLC5jYXJkMywuYXNrMyBgLCB7IG9yaWdpbjogXCJib3R0b21cIiB9KVxyXG5zci5yZXZlYWwoYC5jb250YWN0X19jb250YWluZXJgLCB7IG9yaWdpbjogXCJsZWZ0XCIgfSlcclxuLy8gc3IucmV2ZWFsKGAuZm9vdGVyYCwgeyBvcmlnaW46IFwiYm90dG9tXCIgfSlcclxuc3IucmV2ZWFsKGAuY2FyZDIsLmFzazIsLmFzazRgLCB7IG9yaWdpbjogXCJ0b3BcIiB9KVxyXG5cclxuXHJcblxyXG5zci5yZXZlYWwoYC5hYm91dF9fdGl0bGUsXHJcbi5xdWVzdGlvbl9fdGl0bGUsXHJcbi5vZmZlcl9fdGl0bGUsXHJcbi5zdGVwc19fdGl0bGUsXHJcbi5jb250YWN0X190aXRsZSxcclxuLnByb2R1Y3RzX190aXRsZWAsIHsgZGVsYXk6IDIwMCB9KVxyXG5cclxuXHJcbiJdfQ==
